<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Alcotest (alcotest.Alcotest)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">alcotest</a> &#x00BB; Alcotest</nav><h1>Module <code>Alcotest</code></h1><p>A lightweight and colourful test framework.</p><p><code>Alcotest</code> provides a simple interface to perform unit tests. It exposes a simple <a href="module-type-TESTABLE/index.html"><span>TESTABLE</span></a> module type, a <a href="index.html#val-check"><span>check function</span></a> to assert test predicates and a <a href="index.html#val-run"><span>run</span></a> function to perform a list of <code>unit -&gt; unit</code> test callbacks.</p><p>From these descriptions, <code>Alcotest</code> builds a quiet and colorful output where only faulty runs are fully displayed at the end of the run (with the full logs ready to inspect), with a simple (yet expressive) query language to select the tests to run.</p><p><em>Release 0.8.5</em></p><nav class="toc"><ul><li><a href="#assert-functions">Assert functions</a></li><li><a href="#deprecated">Deprecated</a></li></ul></nav></header><dl><dt class="spec type" id="type-speed_level"><a href="#type-speed_level" class="anchor"></a><code><span class="keyword">type </span>speed_level</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-speed_level.Quick" class="anchored"><td class="def constructor"><a href="#type-speed_level.Quick" class="anchor"></a><code><span class="keyword">| </span></code><code>`Quick</code></td></tr><tr id="type-speed_level.Slow" class="anchored"><td class="def constructor"><a href="#type-speed_level.Slow" class="anchor"></a><code><span class="keyword">| </span></code><code>`Slow</code></td></tr></table><code> ]</code></dt><dd><p>Speed level of a test. Tests marked as <code>`Quick</code> are always run. Tests marked as <code>`Slow</code> are skipped when the `-q` flag is passed.</p></dd></dl><dl><dt class="spec type" id="type-test_case"><a href="#type-test_case" class="anchor"></a><code><span class="keyword">type </span>'a test_case</code><code><span class="keyword"> = </span>string<span class="keyword"> * </span><a href="index.html#type-speed_level">speed_level</a><span class="keyword"> * </span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> unit)</code></dt><dd><p>A test case is an UTF-8 encoded documentation string, a speed level and a function to execute. Typically, the testing function calls the helper functions provided below (such as <code>check</code> and <code>fail</code>).</p></dd></dl><dl><dt class="spec value" id="val-test_case"><a href="#val-test_case" class="anchor"></a><code><span class="keyword">val </span>test_case : string <span>&#45;&gt;</span> <a href="index.html#type-speed_level">speed_level</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-test_case">test_case</a></code></dt><dd><p><code>test_case n s f</code> is the test case <code>n</code> running at speed <code>s</code> using the function <code>f</code>.</p></dd></dl><dl><dt class="spec type" id="type-test"><a href="#type-test" class="anchor"></a><code><span class="keyword">type </span>'a test</code><code><span class="keyword"> = </span>string<span class="keyword"> * </span><span class="type-var">'a</span> <a href="index.html#type-test_case">test_case</a> list</code></dt><dd><p>A test is an US-ASCII encoded name and a list of test cases. * The name can be used for filtering which tests to run on the CLI</p></dd></dl><dl><dt class="spec exception" id="exception-Test_error"><a href="#exception-Test_error" class="anchor"></a><code><span class="keyword">exception </span></code><code><span class="exception">Test_error</span></code></dt><dd><p>The exception return by <a href="index.html#val-run"><code>run</code></a> in case of errors.</p></dd></dl><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val </span>run : ?&#8288;and_exit:bool <span>&#45;&gt;</span> ?&#8288;argv:string array <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit <a href="index.html#type-test">test</a> list <span>&#45;&gt;</span> unit</code></dt><dd><p><code>run n t</code> runs the test suite <code>t</code>. <code>n</code> is the name of the tested library.</p><p>The optional argument <code>and_exit</code> controls what happens when the function ends. By default, <code>and_exit</code> is set, which makes the function exit with <code>0</code> if everything is fine or <code>1</code> if there is an issue. If <code>and_exit</code> is <code>false</code>, then the function raises <code>Test_error</code> on error.</p><p>The optional argument <code>argv</code> specifies the argument sent to alcotest like <code>&quot;--json&quot;</code>, <code>&quot;--verbose&quot;</code>, etc. (at least one argument is required).</p></dd></dl><dl><dt class="spec value" id="val-run_with_args"><a href="#val-run_with_args" class="anchor"></a><code><span class="keyword">val </span>run_with_args : ?&#8288;and_exit:bool <span>&#45;&gt;</span> ?&#8288;argv:string array <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span> Cmdliner.Term.t <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-test">test</a> list <span>&#45;&gt;</span> unit</code></dt><dd><p><code>run_with_args n a t</code> Similar to <code>run a t</code> but take an extra argument <code>a</code>. Every test function will receive as arguement the evaluation of the <code>Cdmliner</code> term <code>a</code>: this is useful to configure the test behaviors using the CLI.</p></dd></dl><section><header><h2 id="assert-functions"><a href="#assert-functions" class="anchor"></a>Assert functions</h2></header><dl><dt class="spec module-type" id="module-type-TESTABLE"><a href="#module-type-TESTABLE" class="anchor"></a><code><span class="keyword">module type </span><a href="module-type-TESTABLE/index.html">TESTABLE</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>TESTABLE</code> provides an abstract description for testable values.</p></dd></dl><dl><dt class="spec type" id="type-testable"><a href="#type-testable" class="anchor"></a><code><span class="keyword">type </span>'a testable</code><code><span class="keyword"> = </span>(<span class="keyword">module </span><a href="module-type-TESTABLE/index.html">TESTABLE</a> <span class="keyword">with</span> <span class="keyword">type </span><a href="module-type-TESTABLE/index.html#type-t">t</a> <span class="keyword">=</span> <span class="type-var">'a</span>)</code></dt><dd><p>The type for testable values.</p></dd></dl><dl><dt class="spec value" id="val-testable"><a href="#val-testable" class="anchor"></a><code><span class="keyword">val </span>testable : <span class="type-var">'a</span> Fmt.t <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>testable pp eq</code> is a new <a href="index.html#type-testable"><code>testable</code></a> with the pretty-printer <code>pp</code> and equality <code>eq</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val </span>pp : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> Fmt.t</code></dt><dd><p><code>pp t</code> is <code>t</code>'s pretty-printer.</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val </span>equal : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal t</code> is <code>t</code>'s equality.</p></dd></dl><dl><dt class="spec value" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span class="keyword">val </span>bool : bool <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>bool</code> tests booleans.</p></dd></dl><dl><dt class="spec value" id="val-int"><a href="#val-int" class="anchor"></a><code><span class="keyword">val </span>int : int <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>int</code> tests integers.</p></dd></dl><dl><dt class="spec value" id="val-int32"><a href="#val-int32" class="anchor"></a><code><span class="keyword">val </span>int32 : int32 <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>int32</code> tests 32-bit integers.</p></dd></dl><dl><dt class="spec value" id="val-int64"><a href="#val-int64" class="anchor"></a><code><span class="keyword">val </span>int64 : int64 <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>int64</code> tests 64-bit integers.</p></dd></dl><dl><dt class="spec value" id="val-float"><a href="#val-float" class="anchor"></a><code><span class="keyword">val </span>float : float <span>&#45;&gt;</span> float <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>float</code> tests floats with specified absolute error.</p></dd></dl><dl><dt class="spec value" id="val-char"><a href="#val-char" class="anchor"></a><code><span class="keyword">val </span>char : char <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>char</code> tests characters.</p></dd></dl><dl><dt class="spec value" id="val-string"><a href="#val-string" class="anchor"></a><code><span class="keyword">val </span>string : string <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>string</code> tests OCaml strings.</p></dd></dl><dl><dt class="spec value" id="val-unit"><a href="#val-unit" class="anchor"></a><code><span class="keyword">val </span>unit : unit <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>unit</code> tests unit values (useful for functions with side-effects).</p></dd></dl><dl><dt class="spec value" id="val-list"><a href="#val-list" class="anchor"></a><code><span class="keyword">val </span>list : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> list <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>list t</code> tests lists of <code>t</code>s.</p></dd></dl><dl><dt class="spec value" id="val-slist"><a href="#val-slist" class="anchor"></a><code><span class="keyword">val </span>slist : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> int) <span>&#45;&gt;</span> <span class="type-var">'a</span> list <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>slist t comp</code> tests sorted lists of <code>t</code>s. The list are sorted using <code>comp</code>.</p></dd></dl><dl><dt class="spec value" id="val-array"><a href="#val-array" class="anchor"></a><code><span class="keyword">val </span>array : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> array <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>array t</code> tests arrays of <code>t</code>s.</p></dd></dl><dl><dt class="spec value" id="val-option"><a href="#val-option" class="anchor"></a><code><span class="keyword">val </span>option : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> option <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>option t</code> tests optional <code>t</code>s.</p></dd></dl><dl><dt class="spec value" id="val-result"><a href="#val-result" class="anchor"></a><code><span class="keyword">val </span>result : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) Result.result <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>result t e</code> tests <code>t</code>s on success and <code>e</code>s on failure.</p></dd></dl><dl><dt class="spec value" id="val-pair"><a href="#val-pair" class="anchor"></a><code><span class="keyword">val </span>pair : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span><span class="keyword"> * </span><span class="type-var">'b</span>) <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>pair a b</code> tests pairs of <code>a</code>s and <code>b</code>s.</p></dd></dl><dl><dt class="spec value" id="val-of_pp"><a href="#val-of_pp" class="anchor"></a><code><span class="keyword">val </span>of_pp : <span class="type-var">'a</span> Fmt.t <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>of_pp pp</code> tests values which can be printed using <code>pp</code> and compared using <span class="xref-unresolved" title="unresolved reference to &quot;Pervasives.compare&quot;"><code>Pervasives</code>.compare</span></p></dd></dl><dl><dt class="spec value" id="val-pass"><a href="#val-pass" class="anchor"></a><code><span class="keyword">val </span>pass : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>pass</code> tests values of any type and always succeeds.</p></dd></dl><dl><dt class="spec value" id="val-reject"><a href="#val-reject" class="anchor"></a><code><span class="keyword">val </span>reject : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>reject</code> tests values of any type and always fails.</p></dd></dl><dl><dt class="spec value" id="val-check"><a href="#val-check" class="anchor"></a><code><span class="keyword">val </span>check : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Check that two values are equal.</p></dd></dl><dl><dt class="spec value" id="val-fail"><a href="#val-fail" class="anchor"></a><code><span class="keyword">val </span>fail : string <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Simply fail.</p></dd></dl><dl><dt class="spec value" id="val-failf"><a href="#val-failf" class="anchor"></a><code><span class="keyword">val </span>failf : (<span class="type-var">'a</span>, Stdlib.Format.formatter, unit, <span class="type-var">'b</span>) Stdlib.format4 <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Simply fail with a formatted message.</p></dd></dl><dl><dt class="spec value" id="val-neg"><a href="#val-neg" class="anchor"></a><code><span class="keyword">val </span>neg : <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-testable">testable</a></code></dt><dd><p><code>neg t</code> is <code>t</code>'s negation: it is <code>true</code> when <code>t</code> is <code>false</code> and it is <code>false</code> when <code>t</code> is <code>true</code>.</p></dd></dl><dl><dt class="spec value" id="val-check_raises"><a href="#val-check_raises" class="anchor"></a><code><span class="keyword">val </span>check_raises : string <span>&#45;&gt;</span> exn <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> unit</code></dt><dd><p>Check that an exception is raised.</p></dd></dl></section><section><header><h2 id="deprecated"><a href="#deprecated" class="anchor"></a>Deprecated</h2></header><dl><dt class="spec value" id="val-line"><a href="#val-line" class="anchor"></a><code><span class="keyword">val </span>line : Stdlib.out_channel <span>&#45;&gt;</span> ?&#8288;color:[ `Blue<span class="keyword"> | </span>`Yellow ] <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><dl><dt>deprecated</dt><dd><p>You should write your own line function. For instance:</p><pre><code class="ml">let line ppf ?color c =
  let line = String.v ~len:terminal_columns (fun _ -&gt; c) in
  match color with
  | Some c -&gt; Fmt.pf ppf &quot;%a\n%!&quot; Fmt.(styled c string)  line
  | None   -&gt; Fmt.pf ppf &quot;%s\n%!&quot;line</code></pre></dd></dl></dd></dl></section></div></body></html>